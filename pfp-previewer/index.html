<html>
    <head>
        <title>sl pfp previewer</title>
    </head>
    <body>
        <canvas id="preview" width="250" height="250"></canvas> <button id="newtab">open pfp in new tab</button>
        <div style="display:flex">
            <div id="icons" style="max-height:80%; width:50%; overflow-y:scroll; margin-top: 10px"></div>
            <div id="frames" style="max-height:80%; width:50%; overflow-y:scroll; margin-top: 10px"></div>
        </div>
        <script>
            (function () {
                const canvas = document.getElementById("preview")
                const ctx = canvas.getContext("2d")

                let currentFrame = '1000001'
                let currentIcon = '400001'

                const frameSelect = document.getElementById("frames")
                const iconSelect = document.getElementById("icons")

                window.onresize = () => {
                    frameSelect.style.height = window.innerHeight - 280
                    frameSelect.style.width = window.innerWidth - 280
                    iconSelect.style.height = window.innerHeight - 280
                    iconSelect.style.width = window.innerWidth - 280
                }

                window.onresize()

                const frameList = ['-1', '1000001', '1000002', '1000003', '1000004', '1000005', '1000006', '1000007', '1000008', '1000011', '1000012', '1000013', '1000014', '1000015', '1000016', '1000017', '1000018', '1000019', '1000020', '1000021', '1000022', '1000023', '1000024', '1000026', '1000027', '1000028', '1000029', '1000031', '1000032', '1000033', '1000034', '1000035', '1000036', '1000037', '1000038', '1000039', '1000040', '1000041', '1000050', '1000051', '1000052', '1000053', '1000054', '1000055', '1000056', '1000057', '1000060', '1000061', '1000062', '1000063', '1000064', '1000065', '1000066', '1000067', '1000068', '1000069', '1000070', '1000071', '1000072', '1000073', '1000074', '1000075', '1000076', '1000077', '1000078', '1000079', '1000080', '1000081', '1000082', '1000083', '1000084', '1000085', '1000086', '1000087', '1000088', '1000089', '1000090']
                const iconList = ["-1","400001","400002","400003","400004","400005","400006","400007","400008","400009","400010","400011","400012","400013","400014","400015","400016","400017","400018","400019","400020","400101","400102","400103","400104","400105","400106","400107","400108","400109","400110","400111","400112","400113","400114","400115","400116","400117","400118","400119","400120","400121","400122","400123","400124","400125","400126","400127","400128","400129","400130","400131","400132","400133","400134","400135","400136","400137","400138","400139","400140","400141","400142","400143","400144","400145","400146","400147","400148","400149","400150","400151","400152","400153","400154","400155","400156","400157","400158","400159","400160","400161","400162","400501","400502","400503","400504","400505","400506","400507","400508","400509","400510","400511","400512","400513","400514","401000","401001","401002","401003","401004","401005","401007","401008","402000","402001","402002","402003","402004","402005","402006","402007","402008","402009","402010","402011","402012","402013","402014","402015","402016","402017","402018","402019","402020","402021","403000","403001","403002","403003","403004","403005","404000","404001","404002","404003","404004","404005","404006","404007","404008","404009","404010","404011","404012","404013","404014","404015","404016","404017","404018","404019","404020","404021","404022","404023","404024","404025","404026","404027","405000","405001","405002","410101","410201","410301","410401","410501","410601","410801","410802","410901","410902","411001","411002","411101","411102","411201","411202","411301","411401","411501","411601","411602","411701","411702","411801","411802","411901","411902","412001","412002","412101","412102","412201","412202","412301","412302","412401","412402","412501","412502","412601","412602","412701","412702","412801","412802","412901","412902","413001","413002","413101","413102","413201","413202","413301","413302","413401","413402","413501","413502","413601","413602","413701","413702","413801","413802","413901","413902","414001","414002","414101","414102","414201","414202"]

                for (let frame of frameList) {
                    let image = new Image(100, 100)
                    image.src = "assets/frames/"+frame+".png"
                    let element = frameSelect.appendChild(image)
                    element.onclick = () => {currentFrame = frame; updateIcon()}
                }
                for (let icon of iconList) {
                    let image = new Image(100, 100)
                    image.src = "assets/icons/"+icon+".png"
                    let element = iconSelect.appendChild(image)
                    element.onclick = () => {currentIcon = icon; updateIcon()}
                }

                const updateIcon = async () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    let frameImg = new Image(250, 250)
                    frameImg.src = "assets/frames/"+currentFrame+".png"
                    frameImg.onload = () => {
                        let iconImg = new Image(250, 250)
                        iconImg.src = "assets/icons/"+currentIcon+".png"
                        iconImg.onload = () => {
                            ctx.drawImage(iconImg, 0, 0)
                            ctx.drawImage(frameImg, 0, 0)
                        }
                    }
                } 

                updateIcon(currentFrame, currentIcon)

                document.getElementById("newtab").onclick = () => {
                    fetch(canvas.toDataURL("image/png"))
                        .then(res => res.blob())
                        .then(blob => window.open(window.URL.createObjectURL(blob)))
                }
            })()
        </script>
    </body>
</html>